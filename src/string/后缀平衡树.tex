如果不需要查询排名, 只需要维护前驱后继关系的题目, 可以直接用二分哈希+set去做.

一般的题目需要查询排名, 这时候就需要写替罪羊树或者Treap维护tag. 插入后缀时如果首字母相同只需比较各自删除首字母后的tag大小即可.

(Treap也具有重量平衡树的性质, 每次插入后影响到的子树大小期望是$O(\log n)$的, 所以每次做完插入操作之后直接暴力重构子树内tag就行了.)