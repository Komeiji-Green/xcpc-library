设序列是$\{a_i\}$, 从左往右, 找到一个最小的且满足$a_{k-1} \le a_{k+1}$的$k$, 找到后合并$a_k$和$a_{k-1}$, 再从当前位置开始向左找最大的$j$满足$a_j \ge a_k + a_{k-1}$(当然是指合并前的), 然后把$a_k + a_{k-1}$插到$j$的后面就行. 一直重复, 直到只剩下一堆石子就可以了.

另外在这个过程中, 可以假设$a_{-1}$和$a_n$是正无穷的, 可省略边界的判别. 把$a_0$设为INF, $a_{n+1}$设为INF-1, 可实现剩余一堆石子时自动结束.