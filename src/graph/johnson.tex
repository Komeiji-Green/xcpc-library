首先前提是图没有负环.

先任选一个起点$s$, 跑一边SPFA, 计算每个点的势$h_u = d_{s, u}$, 然后将每条边$u\to v$的权值$w$修改为$w + h[u] - h[v]$即可, 由最短路的性质显然修改后边权非负.

然后对每个起点跑Dijkstra, 再修正距离$d_{u, v} = d'_{u, v} - h_u + h_v$即可, 复杂度$O(nm\log n)$, 在稀疏图上是要优于Floyd的.